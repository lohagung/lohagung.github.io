<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Aben Ronda</title>
    <link rel="icon" href="/logo.png" type="image/jpeg"/>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
    <style>
        .draggable {
            position: fixed;
        }
        .my-5 {
            margin-top: 0rem;
            margin-bottom: -1rem;
        }
		.hari {
		width: 100px;
		}
		.blok {
			width: 55px;
			background: black;
			color: #fff;
		}

		.nama {
			width: 165px;
		}
    </style>
</head>
<body class="bg-gray-100 flex flex-col min-h-screen">
    <!-- Header -->
    <header class="bg-gradient-to-r from-orange-400 to-orange-300 p-4 flex justify-between items-center">
        <div class="flex items-center">
            <img alt="Logo of Admin Jimpitan, a circular logo with a placeholder design" class="h-10 w-10 rounded-full" height="40" src="/logo.png" width="40"/>
            <span class="text-white font-bold ml-2">Absen Ronda</span>
        </div>
        <div class="relative">
            <div class="flex items-center space-x-4">
                <i class="fas fa-bars text-white cursor-pointer" onclick="toggleMenu()"></i>
            </div>
            <div class="absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-2 z-20 hidden" id="dropdownMenu">
                <a class="block px-4 py-2 text-gray-800 hover:bg-gray-200 cursor-pointer" onclick="toggleSettingsPopup()">Setting</a>
                <a class="block px-4 py-2 text-gray-800 hover:bg-gray-200" href="#">Bendahara</a>
                <a class="block px-4 py-2 text-gray-800 hover:bg-gray-200" href="#">Jimpitan</a>
            </div>
        </div>
    </header>
    <!-- Main Content -->
    <main class="flex-grow p-4">
        <div class="container mx-auto text-center">
            <h1 class="text-2xl font-bold mb-4" id="scheduleTitle"></h1>
            <div id="tablesContainer">
                <!-- Tables will be dynamically generated -->
            </div>
        </div></br></br></br></br><center>@2024 oleh YOUSHE</center>
    </main>
    <!-- Footer -->
    <footer class="bg-white p-4 fixed bottom-0 w-full flex justify-around items-center shadow-md">
    <footer class="bg-white p-4 fixed bottom-0 w-full flex justify-around items-center shadow-md">
        <div class="flex flex-col items-center" onclick="pdfFunction()">
            <i class="fas fa-file-pdf text-red-600 text-2xl"></i>
            <span class="text-gray-600 text-sm">PDF</span>
        </div>
        <div class="flex flex-col items-center" onclick="printFunction()">
            <i class="fas fa-print text-yellow-600 text-2xl"></i>
            <span class="text-gray-600 text-sm">Print</span>
        </div>
    </footer>
    <!-- Floating Plus Button -->
    <div class="draggable bg-yellow-500 text-white h-12 w-12 flex items-center justify-center rounded-full shadow-lg" id="draggable-plus" style="right: 10px; bottom: 50%; transform: translateY(50%);" onclick="toggleDatePopup()">
        <i class="fas fa-plus text-lg"></i>
    </div>
    <!-- Date Popup Form -->
    <div id="datePopupForm" class="fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center hidden">
        <div class="bg-white p-6 rounded-lg shadow-lg w-11/12 md:w-1/2 lg:w-1/3">
            <h2 class="text-xl font-bold mb-4">Set Start Date</h2>
            <form id="datePopupDataForm">
                <div class="mb-4">
                    <label for="startDate" class="block text-gray-700">Start Date:</label>
                    <input type="date" id="startDate" class="mt-1 block w-full p-2 border border-gray-300 rounded-md"/>
                </div>
                <div class="flex justify-end">
                    <button type="button" onclick="generateSchedule()" class="bg-blue-500 text-white px-4 py-2 rounded-md mr-2">Generate</button>
                    <button type="button" onclick="toggleDatePopup()" class="bg-gray-500 text-white px-4 py-2 rounded-md">Cancel</button>
                </div>
            </form>
        </div>
    </div>
    <!-- Settings Popup Form -->
    <div id="settingsPopupForm" class="fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center hidden">
        <div class="bg-white p-6 rounded-lg shadow-lg w-11/12 md:w-1/2 lg:w-1/3">
            <h2 class="text-xl font-bold mb-4">Settings</h2>
            <form id="settingsDataForm">
                <div class="grid grid-cols-2 gap-4">
                    <div class="mb-4">
                        <label for="mondayTextArea" class="block text-gray-700">Senin:</label>
                        <textarea id="mondayTextArea" class="mt-1 block w-full p-2 border border-gray-300 rounded-md" rows="4" placeholder="Nama1,Blok1&#10;Nama2,Blok2&#10;Nama3,Blok3&#10;Nama4,Blok4"></textarea>
                    </div>
                    <div class="mb-4">
                        <label for="tuesdayTextArea" class="block text-gray-700">Selasa:</label>
                        <textarea id="tuesdayTextArea" class="mt-1 block w-full p-2 border border-gray-300 rounded-md" rows="4" placeholder="Nama1,Blok1&#10;Nama2,Blok2&#10;Nama3,Blok3&#10;Nama4,Blok4"></textarea>
                    </div>
                    <div class="mb-4">
                        <label for="wednesdayTextArea" class="block text-gray-700">Rabu:</label>
                        <textarea id="wednesdayTextArea" class="mt-1 block w-full p-2 border border-gray-300 rounded-md" rows="4" placeholder="Nama1,Blok1&#10;Nama2,Blok2&#10;Nama3,Blok3&#10;Nama4,Blok4"></textarea>
                    </div>
                    <div class="mb-4">
                        <label for="thursdayTextArea" class="block text-gray-700">Kamis:</label>
                        <textarea id="thursdayTextArea" class="mt-1 block w-full p-2 border border-gray-300 rounded-md" rows="4" placeholder="Nama1,Blok1&#10;Nama2,Blok2&#10;Nama3,Blok3&#10;Nama4,Blok4"></textarea>
                    </div>
                    <div class="mb-4">
                        <label for="fridayTextArea" class="block text-gray-700">Jumat:</label>
                        <textarea id="fridayTextArea" class="mt-1 block w-full p-2 border border-gray-300 rounded-md" rows="4" placeholder="Nama1,Blok1&#10;Nama2,Blok2&#10;Nama3,Blok3&#10;Nama4,Blok4"></textarea>
                    </div>
                    <div class="mb-4">
                        <label for="saturdayTextArea" class="block text-gray-700">Sabtu:</label>
                        <textarea id="saturdayTextArea" class="mt-1 block w-full p-2 border border-gray-300 rounded-md" rows="4" placeholder="Nama1,Blok1&#10;Nama2,Blok2&#10;Nama3,Blok3&#10;Nama4,Blok4"></textarea>
                    </div>
                    <div class="mb-4 col-span-2">
                        <label for="sundayTextArea" class="block text-gray-700">Minggu:</label>
                        <textarea id="sundayTextArea" class="mt-1 block w-full p-2 border border-gray-300 rounded-md" rows="4" placeholder="Nama1,Blok1&#10;Nama2,Blok2&#10;Nama3,Blok3&#10;Nama4,Blok4"></textarea>
                    </div>
                </div>
                <div class="flex justify-end">
                    <button type="button" onclick="saveSettingsData()" class="bg-blue-500 text-white px-4 py-2 rounded-md mr-2">Save</button>
                    <button type="button" onclick="toggleSettingsPopup()" class="bg-gray-500 text-white px-4 py-2 rounded-md">Cancel</button>
                </div>
            </form>
        </div>
    </div>
    <script>
        function toggleMenu() {
            const menu = document.getElementById('dropdownMenu');
            menu.classList.toggle('hidden');
        }

        function togglePopup() {
            const popup = document.getElementById('popupForm');
            popup.classList.toggle('hidden');
        }

        function toggleDatePopup() {
            const popup = document.getElementById('datePopupForm');
            popup.classList.toggle('hidden');
        }

        function toggleSettingsPopup() {
            const popup = document.getElementById('settingsPopupForm');
            popup.classList.toggle('hidden');
        }



        function saveSettingsData() {
            const monday = document.getElementById('mondayTextArea').value;
            const tuesday = document.getElementById('tuesdayTextArea').value;
            const wednesday = document.getElementById('wednesdayTextArea').value;
            const thursday = document.getElementById('thursdayTextArea').value;
            const friday = document.getElementById('fridayTextArea').value;
            const saturday = document.getElementById('saturdayTextArea').value;
            const sunday = document.getElementById('sundayTextArea').value;

            const settingsData = {
                monday,
                tuesday,
                tuesday,
                wednesday,
                thursday,
                friday,
                saturday,
                sunday
            };

            localStorage.setItem('settingsData', JSON.stringify(settingsData));
            alert('Settings saved!');
            toggleSettingsPopup();
        }

        function loadSettingsData() {
            const settingsData = JSON.parse(localStorage.getItem('settingsData'));
            if (settingsData) {
                document.getElementById('mondayTextArea').value = settingsData.monday;
                document.getElementById('tuesdayTextArea').value = settingsData.tuesday;
                document.getElementById('wednesdayTextArea').value = settingsData.wednesday;
                document.getElementById('thursdayTextArea').value = settingsData.thursday;
                document.getElementById('fridayTextArea').value = settingsData.friday;
                document.getElementById('saturdayTextArea').value = settingsData.saturday;
                document.getElementById('sundayTextArea').value = settingsData.sunday;
            }
        }

        function generateSchedule() {
            const startDate = document.getElementById('startDate').value;
            if (!startDate) {
                alert('Pilih tanggal dulu guest (wajib tanggal 1, yang penting bulan dan tahunnya harus tepat) .');
                return;
            }

            const date = new Date(startDate);
            const year = date.getFullYear();
            const month = date.getMonth();
            const daysInMonth = new Date(year, month + 1, 0).getDate();

            const dayNames = ["Minggu", "Senin", "Selasa", "Rabu", "Kamis", "Jumat", "Sabtu"];
            const monthNames = ["Januari", "Februari", "Maret", "April", "Mei", "Juni", "Juli", "Agustus", "September", "Oktober", "November", "Desember"];

            document.getElementById('scheduleTitle').innerText = `Absen Ronda ${monthNames[month]} ${year}`;

            const tablesContainer = document.getElementById('tablesContainer');
            tablesContainer.innerHTML = '';

            const settingsData = JSON.parse(localStorage.getItem('settingsData'));

            for (let day = 1; day <= daysInMonth; day++) {
                const currentDate = new Date(year, month, day);
                const dayName = dayNames[currentDate.getDay()];

                let headerData = ['', '', '', '', '', '', '', ''];
                if (settingsData) {
                    switch (dayName) {
                        case 'Senin':
                            headerData = settingsData.monday.split('\n').map(line => line.split(',')).flat();
                            break;
                        case 'Selasa':
                            headerData = settingsData.tuesday.split('\n').map(line => line.split(',')).flat();
                            break;
                        case 'Rabu':
                            headerData = settingsData.wednesday.split('\n').map(line => line.split(',')).flat();
                            break;
                        case 'Kamis':
                            headerData = settingsData.thursday.split('\n').map(line => line.split(',')).flat();
                            break;
                        case 'Jumat':
                            headerData = settingsData.friday.split('\n').map(line => line.split(',')).flat();
                            break;
                        case 'Sabtu':
                            headerData = settingsData.saturday.split('\n').map(line => line.split(',')).flat();
                            break;
                        case 'Minggu':
                            headerData = settingsData.sunday.split('\n').map(line => line.split(',')).flat();
                            break;
                    }
                }

                const table = document.createElement('div');
                table.classList.add('mb-2');
                table.innerHTML = `
                    <table class="min-w-full bg-white border border-gray-200 text-center">
                        <thead>
                            <tr>
                                <th class="px-4 py-2 border h-12 hari">Hari/Tgl</th>
                                <th class="px-4 py-2 border h-12 nama">${headerData[0] || '{Nama1}'}</th>
                                <th class="px-4 py-2 border h-12 blok">${headerData[1] || '{Blok1}'}</th>
                                <th class="px-4 py-2 border h-12 nama">${headerData[2] || '{Nama2}'}</th>
                                <th class="px-4 py-2 border h-12 blok">${headerData[3] || '{Blok2}'}</th>
                                <th class="px-4 py-2 border h-12 nama">${headerData[4] || '{Nama3}'}</th>
                                <th class="px-4 py-2 border h-12 blok">${headerData[5] || '{Blok3}'}</th>
                                <th class="px-4 py-2 border h-12 nama">${headerData[6] || '{Nama4}'}</th>
                                <th class="px-4 py-2 border h-12 blok">${headerData[7] || '{Blok4}'}</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="px-4 py-2 border h-24">
                                    <div class="text-lg font-bold">${dayName}</div>
                                    <div class="text-3xl font-bold">${day}</div>
                                </td>
                                <td class="px-4 py-2 border h-24" id="name1Cell" colspan="2"></td>

                                <td class="px-4 py-2 border h-24" id="name2Cell" colspan="2"></td>

                                <td class="px-4 py-2 border h-24" id="name3Cell" colspan="2"></td>

                                <td class="px-4 py-2 border h-24" id="name4Cell" colspan="2"></td>

                            </tr>
                        </tbody>
                    </table>
                    
                `;
                tablesContainer.appendChild(table);
            }
        }

        window.onload = loadSettingsData;
    </script>
</body>
</html>
